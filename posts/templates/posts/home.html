<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Crow - Home</title>

    <!-- Bootstrap CSS for styling -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        /* Basic background color for the entire page */
        body { background: #f5f6f7; }

        /* Style for each post box (card look) */
        .post-card {
            background: white;                 /* white background for readability */
            border-radius: 10px;               /* rounded corners */
            padding: 20px;                     /* inner spacing */
            margin-bottom: 15px;               /* space between posts */
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* light shadow for depth */
        }

        /* Style for small text showing author and timestamp */
        .post-meta {
            color: #777;                       /* light gray text color */
            font-size: 0.9rem;                 /* smaller font size */
        }

        /* Style for the upvote button */
        .upvote-btn {
            background: none;                  /* remove background */
            border: none;                      /* remove border */
            color: #ff4500;                    /* orange color for upvote */
            font-weight: bold;                 /* make text bold */
            cursor: pointer;                   /* show hand cursor on hover */
        }

        /* Centering and spacing for the page header */
        h2 {
            text-align: center;
            margin-bottom: 1.5rem;
        }
    </style>
</head>

<body class="container py-4">
    <!-- Page Title -->
    <h2>Welcome to Crow</h2>

    <!-- ========================= -->
    <!-- Post Creation Form Section -->
    <!-- ========================= -->
    <div class="card p-3 mb-4">
        <h5>Create a New Post</h5>

        <!-- Form for submitting a new post -->
        <form method="POST">
            {% csrf_token %}  <!-- Django security token to prevent CSRF attacks -->

            <!-- Title input field -->
            <input type="text" name="title" class="form-control mb-2" placeholder="Title" required>

            <!-- Content text area -->
            <textarea name="content" class="form-control mb-2" placeholder="What's on your mind?" rows="4" required></textarea>

            <!-- Submit button -->
            <button type="submit" class="btn btn-primary w-100">Post</button>
        </form>
    </div>

    <!-- ========================= -->
    <!-- Posts Display Section -->
    <!-- ========================= -->
    <h4 class="mb-3">Latest Posts</h4>

    <!-- Django loop to display all posts -->
    {% for post in posts %}
        <div class="post-card">
            <!-- Post title -->
            <h5>{{ post.title }}</h5>

            <!-- Post content -->
            <p>{{ post.content }}</p>

            <!-- Author name, timestamp, and upvote button -->
            <div class="d-flex justify-content-between align-items-center">
                <!-- Display author name and created date -->
                <small class="post-meta">
                    By <strong>{{ post.author.username }}</strong> |
                    {{ post.created_at|date:"M d, Y H:i" }}
                </small>

                <!-- Form for upvoting a post -->
                <form method="POST" action="{% url 'upvote_post' post.id %}">
                    {% csrf_token %}
                    <!-- Upvote button with current count -->
                    <button type="submit" class="upvote-btn">â¬† {{ post.upvotes }}</button>
                </form>
            </div>
        </div>

    <!-- Message if there are no posts -->
    {% empty %}
        <p>No posts yet.</p>
    {% endfor %}
</body>
</html>
